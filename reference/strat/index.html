
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Stratigraphy operations &#8212; DeltaMetrics 0.4.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinxdoc.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="deltametrics.strat.compute_compensation" href="../../_autosummary/deltametrics.strat.compute_compensation.html" />
    <link rel="prev" title="deltametrics.section.BaseSection" href="../../_autosummary/deltametrics.section.BaseSection.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../_autosummary/deltametrics.strat.compute_compensation.html" title="deltametrics.strat.compute_compensation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../_autosummary/deltametrics.section.BaseSection.html" title="deltametrics.section.BaseSection"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DeltaMetrics 0.4.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">API reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Stratigraphy operations</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="stratigraphy-operations">
<h1>Stratigraphy operations<a class="headerlink" href="#stratigraphy-operations" title="Permalink to this heading">¶</a></h1>
<p>The package makes available functions relating to computing things based on
stratigraphy.</p>
<p>The functions are defined in <code class="docutils literal notranslate"><span class="pre">deltametrics.strat</span></code>.</p>
<section id="stratigraphy-statistics-functions">
<h2>Stratigraphy statistics functions<a class="headerlink" href="#stratigraphy-statistics-functions" title="Permalink to this heading">¶</a></h2>
<p>Metrics and statistics of stratigraphy.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../_autosummary/deltametrics.strat.compute_compensation.html#deltametrics.strat.compute_compensation" title="deltametrics.strat.compute_compensation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_compensation</span></code></a>(line1, line2)</p></td>
<td><p>Compute compensation statistic betwen two lines.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../_autosummary/deltametrics.strat.compute_net_to_gross.html#deltametrics.strat.compute_net_to_gross" title="deltametrics.strat.compute_net_to_gross"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_net_to_gross</span></code></a>(sediment_volume[, ...])</p></td>
<td><p>Compute net-to-gross for stratigraphy.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../_autosummary/deltametrics.strat.compute_thickness_surfaces.html#deltametrics.strat.compute_thickness_surfaces" title="deltametrics.strat.compute_thickness_surfaces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_thickness_surfaces</span></code></a>(top_surface, ...)</p></td>
<td><p>Compute deposit thickness.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../_autosummary/deltametrics.strat.compute_sedimentograph.html#deltametrics.strat.compute_sedimentograph" title="deltametrics.strat.compute_sedimentograph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_sedimentograph</span></code></a>(sediment_volume[, ...])</p></td>
<td><p>Compute the sedimentograph.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="compute-stratigraphy-routines">
<h2>Compute stratigraphy routines<a class="headerlink" href="#compute-stratigraphy-routines" title="Permalink to this heading">¶</a></h2>
<p>Routines to compute stratigraphic volumes.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../_autosummary/deltametrics.strat.compute_boxy_stratigraphy_volume.html#deltametrics.strat.compute_boxy_stratigraphy_volume" title="deltametrics.strat.compute_boxy_stratigraphy_volume"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_boxy_stratigraphy_volume</span></code></a>(elev, prop)</p></td>
<td><p>Process t-x-y data volume to boxy stratigraphy volume.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../_autosummary/deltametrics.strat.compute_boxy_stratigraphy_coordinates.html#deltametrics.strat.compute_boxy_stratigraphy_coordinates" title="deltametrics.strat.compute_boxy_stratigraphy_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_boxy_stratigraphy_coordinates</span></code></a>(elev)</p></td>
<td><p>Process t-x-y data volume to boxy stratigraphy coordinates.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="quick-stratigraphy-attributes-classes">
<h2>Quick-stratigraphy attributes classes<a class="headerlink" href="#quick-stratigraphy-attributes-classes" title="Permalink to this heading">¶</a></h2>
<p>The “quick” stratigraphy attributes provide a common API that is accessed by
<cite>DataCube</cite>, <cite>DataSectionVariable</cite> and <cite>DataPlanformVariable</cite> methods. There
are two methods of computing quick stratigraphy, with
<a class="reference internal" href="../../_autosummary/deltametrics.strat.MeshStratigraphyAttributes.html#deltametrics.strat.MeshStratigraphyAttributes" title="deltametrics.strat.MeshStratigraphyAttributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MeshStratigraphyAttributes</span></code></a> as the default.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../_autosummary/deltametrics.strat.MeshStratigraphyAttributes.html#deltametrics.strat.MeshStratigraphyAttributes" title="deltametrics.strat.MeshStratigraphyAttributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MeshStratigraphyAttributes</span></code></a>(elev, **kwargs)</p></td>
<td><p>Attribute set for mesh stratigraphy information, emebdded into a DataCube.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../_autosummary/deltametrics.strat.BoxyStratigraphyAttributes.html#deltametrics.strat.BoxyStratigraphyAttributes" title="deltametrics.strat.BoxyStratigraphyAttributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BoxyStratigraphyAttributes</span></code></a>()</p></td>
<td><p>Attribute set for boxy stratigraphy information, emebdded into a DataCube.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../_autosummary/deltametrics.strat.BaseStratigraphyAttributes.html#deltametrics.strat.BaseStratigraphyAttributes" title="deltametrics.strat.BaseStratigraphyAttributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseStratigraphyAttributes</span></code></a>(style)</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="low-level-stratigraphy-utility-functions">
<h2>Low-level stratigraphy utility functions<a class="headerlink" href="#low-level-stratigraphy-utility-functions" title="Permalink to this heading">¶</a></h2>
<p>The functions outlined in this section are the main functions that do the actual work of computing stratigraphy and preservation, throughout DeltaMetrics. These functions may be useful if you are trying to use parts of DeltaMetrics, but need to customize something for your own use-case.</p>
<dl class="py function">
<dt class="sig sig-object py" id="deltametrics.strat._compute_elevation_to_preservation">
<span class="sig-prename descclassname"><span class="pre">deltametrics.strat.</span></span><span class="sig-name descname"><span class="pre">_compute_elevation_to_preservation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deltametrics.strat._compute_elevation_to_preservation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the preserved elevations of stratigraphy.</p>
<p>Given elevation data alone, we can compute the preserved stratal surfaces.
These surfaces depend on the timeseries of bed elevation at any spatial
location. We determine preservation by marching backward in time,
determining when was the most recent time that the bed elevation was equal
to a given elevation.</p>
<p>This function is declared as private and not part of the public API,
however some users may find it helpful. The function is heavily utlized
internally. Function inputs and outputs are standard numpy <cite>ndarray</cite>, so
that these functions can accept data from an arbitrary source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elev</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">xr.core.dataarray.DataArray</span></code>) – The <cite>t-x-y</cite> volume of elevation data to determine stratigraphy.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>strata</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code>) – A <cite>t-x-y</cite> <cite>ndarry</cite> of stratal surface elevations.</p></li>
<li><p><strong>psvd</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code>) – A <cite>t-x-y</cite> boolean <cite>ndarry</cite> of whether a <cite>(t,x,y)</cite> point of
instantaneous time is preserved in any of the final stratal surfaces.
To determine whether time from a given <em>timestep</em> is preserved, use
<code class="docutils literal notranslate"><span class="pre">psvd.nonzero()[0]</span> <span class="pre">-</span> <span class="pre">1</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deltametrics.strat._compute_preservation_to_time_intervals">
<span class="sig-prename descclassname"><span class="pre">deltametrics.strat.</span></span><span class="sig-name descname"><span class="pre">_compute_preservation_to_time_intervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psvd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deltametrics.strat._compute_preservation_to_time_intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the preserved timesteps.</p>
<p>The output from <a class="reference internal" href="#deltametrics.strat._compute_elevation_to_preservation" title="deltametrics.strat._compute_elevation_to_preservation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_compute_elevation_to_preservation</span></code></a> records whether
an instance of time, defined exactly at the data interval, is recorded in
the stratigraphy (here, “recorded” does not include stasis). This differs
from determining which <em>time-intervals</em> are preserved in the stratigraphy,
because the deposits reflect the conditions <em>between</em> the save intervals.</p>
<p>While this computation is simply an offset-by-one indexing (<code class="docutils literal notranslate"><span class="pre">psvd[1:,</span>
<span class="pre">...]</span></code>), the function is implemented explicitly and utilized internally
for consistency.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>True</cite> in the preserved time-interval array does not necessarily
indicate that an entire timestep was preserved, but rather that some
portion of this time-interval (up to the entire interval) is recorded.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>psvd</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code>) – Boolean <cite>ndarray</cite> indicating the preservation of instances of time.
Time is expected to be the 0th axis.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>psvd_intervals</strong> – Boolean <cite>ndarray</cite> indicating the preservation of time-intervals,
including partial intervals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deltametrics.strat._compute_preservation_to_cube">
<span class="sig-prename descclassname"><span class="pre">deltametrics.strat.</span></span><span class="sig-name descname"><span class="pre">_compute_preservation_to_cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deltametrics.strat._compute_preservation_to_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the cube-data coordinates to strata coordinates.</p>
<p>Given elevation preservation data (e.g., data from
<a class="reference internal" href="#deltametrics.strat._compute_elevation_to_preservation" title="deltametrics.strat._compute_elevation_to_preservation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_compute_elevation_to_preservation</span></code></a>), compute
the coordinate mapping from <cite>t-x-y</cite> data to <cite>z-x-y</cite> preserved
stratigraphy.</p>
<p>While stratigraphy is time-dependent, preservation at any spatial x-y
location is independent of any other location. Thus, the computation is
vectorized to sweep through all “stratigraphic columns” simultaneously.
The operation works by beginning at the highest elevation of the
stratigraphic volume, and sweeping down though all elevations with an
<cite>x-y</cite> “plate”. The plate indicates whether sediments are preserved below
the current iteration elevation, at each x-y location.</p>
<p>Once the iteration elevation is less than the strata surface at any x-y
location, there will <em>always</em> be sediments preserved below it, at every
elevation. We simply need to determine which time interval these sediments
record. Then we store this time indicator into the sparse array.</p>
<p>So, in the end, coordinates in resultant boxy stratigraphy are linked to
<cite>t-x-y</cite> coordinates in the data source, by building a mapping that can be
utilized repeatedly from a single stratigraphy computation.</p>
<p>This function is declared as private and not part of the public API,
however some users may find it helpful. The function is heavily utlized
internally. Function inputs and outputs are standard numpy <cite>ndarray</cite>, so
that these functions can accept data from an arbitrary source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>strata</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code>) – A <cite>t-x-y</cite> <cite>ndarry</cite> of stratal surface elevations. Can be computed by
<a class="reference internal" href="#deltametrics.strat._compute_elevation_to_preservation" title="deltametrics.strat._compute_elevation_to_preservation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_compute_elevation_to_preservation</span></code></a>.</p></li>
<li><p><strong>z</strong> – Vertical coordinates of stratigraphy. Note that <cite>z</cite> does not need to
have regular intervals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>strat_coords</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code>) – An <cite>N x 3</cite> array of <cite>z-x-y</cite> coordinates where information is preserved
in the boxy stratigraphy. Rows in <cite>strat_coords</cite> correspond with
rows in <cite>data_coords</cite>.</p></li>
<li><p><strong>data_coords</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code>) – An <cite>N x 3</cite> array of <cite>t-x-y</cite> coordinates where information is to be
extracted from the data array. Rows in <cite>data_coords</cite> correspond
with rows in <cite>strat_coords</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deltametrics.strat._determine_strat_coordinates">
<span class="sig-prename descclassname"><span class="pre">deltametrics.strat.</span></span><span class="sig-name descname"><span class="pre">_determine_strat_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deltametrics.strat._determine_strat_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a valid Z array for stratigraphy based on inputs.</p>
<p>This helper function enables support for user specified <cite>dz</cite>, <cite>nz</cite>, or <cite>z</cite>
in many functions. The logic for determining how to handle these mutually
exclusive inputs is placed in this function, to ensure consistent behavior
across all classes/methods internally.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If none of the optional parameters is supplied, then a default value
is used of <cite>dz=0.1</cite>.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Precedence when multiple arguments are supplied is <cite>z</cite>, <cite>dz</cite>, <cite>nz</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code>) – An up-to-three-dimensional array with timeseries of elevation values,
where elevation is expected to along the zeroth axis.</p></li>
<li><p><strong>z</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code>, optional) – Array of Z values to use for bounding intervals (i.e., points in <cite>z</cite>),
returned unchanged if supplied.</p></li>
<li><p><strong>dz</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional) – Interval in created Z array. Z array is created as
<code class="docutils literal notranslate"><span class="pre">np.arange(np.min(elev),</span> <span class="pre">np.max(elev)+dz,</span> <span class="pre">step=dz)</span></code>.</p></li>
<li><p><strong>nz</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional) – Number of <em>intervals</em> in <cite>z</cite>, that is, the number of points in <cite>z</cite> is
<cite>nz+1</cite>. Z array is created as <code class="docutils literal notranslate"><span class="pre">np.linspace(np.min(elev),</span> <span class="pre">np.max</span>
<span class="pre">(elev),</span> <span class="pre">num=nz,</span> <span class="pre">endpoint=True)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deltametrics.strat._adjust_elevation_by_subsidence">
<span class="sig-prename descclassname"><span class="pre">deltametrics.strat.</span></span><span class="sig-name descname"><span class="pre">_adjust_elevation_by_subsidence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_dist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deltametrics.strat._adjust_elevation_by_subsidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust elevation array by subsidence rates.
Given the elevation information and information about the distance
subsided, the true sedimentation and erosion pattern can be unraveled.
The function is written flexibly to handle subsidence distance information
provided as either a single constant value, a constant value over a 2-D
spatial pattern, a 1-D temporal vector when the distance changes but
is applied to the entire domain, and finally a full t-x-y 3-D array with
subsidence information for each x-y position in the domain at each
instance in time.
Critically, when temporal information is provided (either 1-D vector or
full 3-D array) values are assumed to be cumulative subsidence distances
at each index in time. Alternatively, when constant information is given
(1-D float/int, or 2-D x-y array) it is assumed that the constant values
reported represent the distance subsided per temporal index.
This function is declared as a private function and is not part of the
public API. Higher level functions make a call internally to adjust the
elevation data based on subsidence rate information when the optional
argument <cite>sigma_dist</cite> is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">xr.core.dataarray.DataArray</span></code>) – The <cite>t-x-y</cite> volume of elevation data to determine stratigraphy.</p></li>
<li><p><strong>sigma_dist</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">xr.core.dataarray.DataArray</span></code>,) – <code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>
The subsidence information. If a single float or int is provided,
that value is assumed to apply across the entire domain for all times.
If a 2-D array is provided, the distances are assumed for each
x-y location and are applied across all times. If a 1-D vector is
provided, it is assumed that each value applies to all locations in
the domain for a given time. If a full 3-D array is provided, it is
assumed to follow the same <cite>t-x-y</cite> convention as the elevation data.
Positive distances indicate subsidence, negative distances are uplift.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>elev_adjusted</strong> – A <cite>t-x-y</cite> <cite>ndarray</cite> of the same shape as the input <cite>elev</cite> array, but
the values have all been adjusted by the subsidence information
provided by the input <cite>sigma_dist</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deltametrics.strat._determine_deposit_from_background">
<span class="sig-prename descclassname"><span class="pre">deltametrics.strat.</span></span><span class="sig-name descname"><span class="pre">_determine_deposit_from_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sediment_volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deltametrics.strat._determine_deposit_from_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for stratigraphic functions.</p>
<p>Determine the boolean mask of the deposit, i.e., excluding the
pre-deposition basin topography.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sediment_volume</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">xarray</span></code> or <cite>ndarray</cite>) – The deposit voxel array. First dimension is vertical spatial
dimension. In this function, the data here is used only when
<cite>background</cite> is specified as a constant, or for shape if no input is
given.</p></li>
<li><p><strong>background</strong> (<cite>xarray</cite>, <cite>ndarray</cite>, or <cite>float</cite>, optional) – Value indicating the background or basin voxels that should be
excluded from computation. If an array matching the size
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">sediment_volume</span></code> is supplied, this array is assumed to be a
binary array indicating the voxels to be excluded (i.e., the
<cite>deposit</cite> is the inverse of <cite>background</cite>). If a float is passed, this
is treated as a “no-data” value, and used to determine the background
voxels. If no value is supplied, no voxels are excluded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>deposit</strong> – Boolean, with same shape as <cite>background</cite>, indicating where the volume
is deposit (<cite>True</cite>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">DataArray</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>This example shows how choice of background affect the background used for
stratigraphic computations.</p>
<p>The first background calculation simply uses the initial basin topography
to determine the background voxels, but this ignores erosion and
subsequent infilling.</p>
<p>The second background calculation considers this infilling of erosional
channels by including the inflill in the deposit, and not in the
background.</p>
<p>The third background shows the effect of using a constant value as the
background value; hint: this is generally a bad idea unless your data has
a background value encoded into it (like <code class="docutils literal notranslate"><span class="pre">-1</span></code> or <cite>9999</cite>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">golfcube</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">sample_data</span><span class="o">.</span><span class="n">golf</span><span class="p">()</span>
<span class="n">golfstrat</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">StratigraphyCube</span><span class="o">.</span><span class="n">from_DataCube</span><span class="p">(</span><span class="n">golfcube</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># background determined from initial basin topography</span>
<span class="n">background0</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">strat</span><span class="o">.</span><span class="n">_determine_deposit_from_background</span><span class="p">(</span>
    <span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">],</span>
    <span class="n">background</span><span class="o">=</span><span class="n">golfstrat</span><span class="o">.</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># background determined from min of bed elevation timeseries</span>
<span class="n">background1</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">strat</span><span class="o">.</span><span class="n">_determine_deposit_from_background</span><span class="p">(</span>
    <span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">],</span>
    <span class="n">background</span><span class="o">=</span><span class="p">(</span><span class="n">golfstrat</span><span class="o">.</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span>
<span class="c1"># background determined from a fixed sandfrac value</span>
<span class="n">background2</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">strat</span><span class="o">.</span><span class="n">_determine_deposit_from_background</span><span class="p">(</span>
    <span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">],</span>
    <span class="n">background</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">background0</span><span class="p">[</span><span class="mi">59</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">)</span>  <span class="c1"># just below initial basin depth</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">background0</span><span class="p">[</span><span class="mi">60</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">)</span>  <span class="c1"># just above initial basin depth</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">background1</span><span class="p">[</span><span class="mi">59</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">)</span>  <span class="c1"># just below initial basin depth</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">background2</span><span class="p">[</span><span class="mi">59</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">)</span>  <span class="c1"># just below initial basin depth</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../reference/strat/index-1.png">png</a>, <a class="reference external" href="../../reference/strat/index-1.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../../_images/index-12.png" class="plot-directive" src="../../_images/index-12.png" />
</figure>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Stratigraphy operations</a><ul>
<li><a class="reference internal" href="#stratigraphy-statistics-functions">Stratigraphy statistics functions</a></li>
<li><a class="reference internal" href="#compute-stratigraphy-routines">Compute stratigraphy routines</a></li>
<li><a class="reference internal" href="#quick-stratigraphy-attributes-classes">Quick-stratigraphy attributes classes</a></li>
<li><a class="reference internal" href="#low-level-stratigraphy-utility-functions">Low-level stratigraphy utility functions</a><ul>
<li><a class="reference internal" href="#deltametrics.strat._compute_elevation_to_preservation"><code class="docutils literal notranslate"><span class="pre">_compute_elevation_to_preservation()</span></code></a></li>
<li><a class="reference internal" href="#deltametrics.strat._compute_preservation_to_time_intervals"><code class="docutils literal notranslate"><span class="pre">_compute_preservation_to_time_intervals()</span></code></a></li>
<li><a class="reference internal" href="#deltametrics.strat._compute_preservation_to_cube"><code class="docutils literal notranslate"><span class="pre">_compute_preservation_to_cube()</span></code></a></li>
<li><a class="reference internal" href="#deltametrics.strat._determine_strat_coordinates"><code class="docutils literal notranslate"><span class="pre">_determine_strat_coordinates()</span></code></a></li>
<li><a class="reference internal" href="#deltametrics.strat._adjust_elevation_by_subsidence"><code class="docutils literal notranslate"><span class="pre">_adjust_elevation_by_subsidence()</span></code></a></li>
<li><a class="reference internal" href="#deltametrics.strat._determine_deposit_from_background"><code class="docutils literal notranslate"><span class="pre">_determine_deposit_from_background()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../../_autosummary/deltametrics.section.BaseSection.html"
                          title="previous chapter">deltametrics.section.BaseSection</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../../_autosummary/deltametrics.strat.compute_compensation.html"
                          title="next chapter">deltametrics.strat.compute_compensation</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/reference/strat/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../_autosummary/deltametrics.strat.compute_compensation.html" title="deltametrics.strat.compute_compensation"
             >next</a> |</li>
        <li class="right" >
          <a href="../../_autosummary/deltametrics.section.BaseSection.html" title="deltametrics.section.BaseSection"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DeltaMetrics 0.4.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >API reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Stratigraphy operations</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, The DeltaRCM Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>