
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Computing a sedimentograph for sand fraction and for preserved time &#8212; DeltaMetrics 0.4.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinxdoc.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Subject Guides" href="../../subject_guides/index.html" />
    <link rel="prev" title="Accounting for subsidence when computing stratigraphy" href="accounting_for_subsidence.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../subject_guides/index.html" title="Subject Guides"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="accounting_for_subsidence.html" title="Accounting for subsidence when computing stratigraphy"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DeltaMetrics 0.4.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Examples</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Computing a sedimentograph for sand fraction and for preserved time</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="computing-a-sedimentograph-for-sand-fraction-and-for-preserved-time">
<h1>Computing a sedimentograph for sand fraction and for preserved time<a class="headerlink" href="#computing-a-sedimentograph-for-sand-fraction-and-for-preserved-time" title="Permalink to this heading">¶</a></h1>
<p>In this example, we explore the sedimentograph <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
The sedimentograph is a measure of sand fraction of delta stratigraphy. In this implementation, a series of concentric CircularSection are drawn with increasing radius, so the sedimentograph is a function of space.</p>
<p>First, a simple example of computing the sedimentograph, using the <a class="reference internal" href="../../../_autosummary/deltametrics.strat.compute_sedimentograph.html#deltametrics.strat.compute_sedimentograph" title="deltametrics.strat.compute_sedimentograph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_sedimentograph</span></code></a> function.</p>
<p>By default, the function will generate two bins for the data input for the <code class="docutils literal notranslate"><span class="pre">sediment_volume</span></code> argument, with the bin divider in the data-range midpoint (i.e., <code class="docutils literal notranslate"><span class="pre">0.5</span></code> for <code class="docutils literal notranslate"><span class="pre">sandfrac</span></code> data).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up the data source</span>
<span class="n">golfcube</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">sample_data</span><span class="o">.</span><span class="n">golf</span><span class="p">()</span>
<span class="n">golfstrat</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">StratigraphyCube</span><span class="o">.</span><span class="n">from_DataCube</span><span class="p">(</span><span class="n">golfcube</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">background</span> <span class="o">=</span> <span class="p">(</span><span class="n">golfstrat</span><span class="o">.</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">frozen_sand</span> <span class="o">=</span> <span class="n">golfstrat</span><span class="o">.</span><span class="n">export_frozen_variable</span><span class="p">(</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">sedimentograph</span><span class="p">,</span>
    <span class="n">section_radii</span><span class="p">,</span>
    <span class="n">sediment_bins</span><span class="p">)</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">strat</span><span class="o">.</span><span class="n">compute_sedimentograph</span><span class="p">(</span>
    <span class="n">frozen_sand</span><span class="p">,</span>
    <span class="n">num_sections</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">last_section_radius</span><span class="o">=</span><span class="mi">2750</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span>
    <span class="n">origin_idx</span><span class="o">=</span><span class="p">[</span><span class="n">golfcube</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;L0&#39;</span><span class="p">],</span> <span class="n">golfcube</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;CTR&#39;</span><span class="p">]])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">section_radii</span><span class="p">,</span>
    <span class="n">sedimentograph</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># plot only the second bin (sandfrac &gt; 0.5)</span>
    <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;radial distance from apex (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;stratigraphy &quot;sandfrac&quot; fraction &gt; 0.5&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../../guides/examples/computations/computing_sedimentograph-1.png">png</a>, <a class="reference external" href="../../../guides/examples/computations/computing_sedimentograph-1.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../../../_images/computing_sedimentograph-1.png" class="plot-directive" src="../../../_images/computing_sedimentograph-1.png" />
</figure>
<p>We can mask a portion of the domain, and compute the sedimentograph over just a portion of the domain.
The result is a (only slightly) different sedimentograph.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">GM</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">GeometricMask</span><span class="p">(</span>
    <span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">angular</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">theta1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">theta2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">))</span>
    <span class="p">)</span>
<span class="n">GM_mask_strat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">GM</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="n">golfstrat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># a mask with same dimensions as stratigraphy</span>
<span class="n">frozen_sand_mask</span> <span class="o">=</span> <span class="n">frozen_sand</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">GM_mask_strat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

<span class="p">(</span><span class="n">sedimentograph2</span><span class="p">,</span>
    <span class="n">section_radii2</span><span class="p">,</span>
    <span class="n">sediment_bins2</span><span class="p">)</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">strat</span><span class="o">.</span><span class="n">compute_sedimentograph</span><span class="p">(</span>
    <span class="n">frozen_sand_mask</span><span class="p">,</span>
    <span class="n">num_sections</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="c1"># last_section_radius=2750,</span>
    <span class="n">sediment_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span>
    <span class="n">origin_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>

<span class="c1"># add this line to the same plot as above</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">section_radii2</span><span class="p">,</span>
    <span class="n">sedimentograph2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># plot only the second bin (sandfrac &gt; 0.5)</span>
    <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../../guides/examples/computations/computing_sedimentograph-2.png">png</a>, <a class="reference external" href="../../../guides/examples/computations/computing_sedimentograph-2.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../../../_images/computing_sedimentograph-2.png" class="plot-directive" src="../../../_images/computing_sedimentograph-2.png" />
</figure>
<section id="using-the-sedimentograph-to-evaluate-time-distribution-in-subsurface">
<h2>Using the sedimentograph to evaluate time distribution in subsurface<a class="headerlink" href="#using-the-sedimentograph-to-evaluate-time-distribution-in-subsurface" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">time_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">golfcube</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="p">(</span><span class="n">time_sedimentograph</span><span class="p">,</span>
    <span class="n">time_radii</span><span class="p">,</span>
    <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">strat</span><span class="o">.</span><span class="n">compute_sedimentograph</span><span class="p">(</span>
    <span class="n">golfstrat</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
    <span class="n">num_sections</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">last_section_radius</span><span class="o">=</span><span class="mi">2750</span><span class="p">,</span>
    <span class="n">sediment_bins</span><span class="o">=</span><span class="n">time_bins</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span>
    <span class="n">origin_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s1">&#39;viridis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">cycler</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">cycler</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">time_radii</span><span class="p">,</span>
    <span class="n">time_sedimentograph</span><span class="p">,</span>
    <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">time_bin_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time_bins</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">--</span><span class="si">{</span><span class="n">time_bins</span><span class="p">[</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> million seconds&quot;</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">time_bin_labels</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;radial distance from apex (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;stratigraphy fraction in time bin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../../guides/examples/computations/computing_sedimentograph-3.png">png</a>, <a class="reference external" href="../../../guides/examples/computations/computing_sedimentograph-3.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../../../_images/computing_sedimentograph-3.png" class="plot-directive" src="../../../_images/computing_sedimentograph-3.png" />
</figure>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Liang, M., Van Dyk, C., and Passalacqua, P. (2016), Quantifying
the patterns and dynamics of river deltas under conditions of
steady forcing and relative sea level rise, J. Geophys. Res.
Earth Surf., 121, 465– 496, doi:10.1002/2015JF003653.</p>
</aside>
</aside>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Computing a sedimentograph for sand fraction and for preserved time</a><ul>
<li><a class="reference internal" href="#using-the-sedimentograph-to-evaluate-time-distribution-in-subsurface">Using the sedimentograph to evaluate time distribution in subsurface</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="accounting_for_subsidence.html"
                          title="previous chapter">Accounting for subsidence when computing stratigraphy</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../../subject_guides/index.html"
                          title="next chapter">Subject Guides</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/guides/examples/computations/computing_sedimentograph.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../subject_guides/index.html" title="Subject Guides"
             >next</a> |</li>
        <li class="right" >
          <a href="accounting_for_subsidence.html" title="Accounting for subsidence when computing stratigraphy"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DeltaMetrics 0.4.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Examples</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Computing a sedimentograph for sand fraction and for preserved time</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, The DeltaRCM Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>