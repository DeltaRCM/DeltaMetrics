
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>User Guide &#8212; DeltaMetrics 0.3.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="examples/index.html" />
    <link rel="prev" title="Getting started with a 10-minute tutorial" href="10min.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="examples/index.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="10min.html" title="Getting started with a 10-minute tutorial"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DeltaMetrics 0.3.3 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">User Guide</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="user-guide">
<h1>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this heading">¶</a></h1>
<p>This documentation provides some “workflow” examples as well as some explanations and background about the various methods available in DeltaMetrics.</p>
<section id="setting-up-your-coding-environment">
<h2>Setting up your coding environment<a class="headerlink" href="#setting-up-your-coding-environment" title="Permalink to this heading">¶</a></h2>
<p>All of the documentation in this package assumes that you have imported the DeltaMetrics package as <code class="docutils literal notranslate"><span class="pre">dm</span></code>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">deltametrics</span> <span class="k">as</span> <span class="nn">dm</span>
</pre></div>
</div>
<p>Additionally, we frequently rely on the <cite>numpy</cite> package, and <cite>matplotlib</cite>. We will assume you have imported these packages by their common shorthand as well; if we import other packages, or other modules from <cite>matplotlib</cite>, these imports will be declared!</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</section>
<section id="create-and-manipulate-a-datacube">
<h2>Create and manipulate a “DataCube”<a class="headerlink" href="#create-and-manipulate-a-datacube" title="Permalink to this heading">¶</a></h2>
<p>DeltaMetrics centers around the use of “Cubes”.
In DeltaMetrics, these <cite>Cube</cite> objects are the central office that connects all the different modules and a workflow together.
The base cube is the <cite>DataCube</cite>, which is set up to handle multi-variable three-dimensional datasets; for example, 2D-spatial timeseries data of multiple variables.</p>
<p>The data of the <cite>DataCube</cite> can come from a file or can be directly passed; where possible, loading from a file is usually preferred, because it is memory-efficient.
Connecting to a netCDF file on disk is as simple as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">acube</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">DataCube</span><span class="p">(</span><span class="s1">&#39;/path/to/data/file.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>For more information about data files, and how to configure your data to work with DeltaMetrics, please visit the <code class="docutils literal notranslate"><span class="pre">Examples/io</span></code> section of the documentation.</p>
</div>
<p>For this guide to be easy to follow along with, we will use some sample data that comes with DeltaMetrics.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">sample_data</span><span class="o">.</span><span class="n">golf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span>
<span class="go">&lt;deltametrics.cube.DataCube object at 0x...&gt;</span>
</pre></div>
</div>
<p>Creating the <code class="docutils literal notranslate"><span class="pre">golfcube</span></code> connects to a dataset on your computer (the file is downloaded if it has not already been downloaded).
Creating the <cite>DataCube</cite> though, does not read any of the data into memory, allowing for efficient computation on large datasets.</p>
<p>Inspect which variables are available in the <code class="docutils literal notranslate"><span class="pre">golfcube</span></code>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">variables</span>
<span class="go">[&#39;eta&#39;, &#39;stage&#39;, &#39;depth&#39;, &#39;discharge&#39;, &#39;velocity&#39;, &#39;sedflux&#39;, &#39;sandfrac&#39;]</span>
</pre></div>
</div>
<p>We can access the underlying variables by name.
The returned object is an <cite>xarray</cite> <cite>DataArray</cite> with coordinates matching the underlying data source.
Per <cite>xarray</cite>, the underlying <cite>data</cite> field contains a <cite>numpy</cite> array.
For example, access variables as:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">])</span>
<span class="go">&lt;class &#39;xarray.core.dataarray.DataArray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="go">&lt;class &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(101, 100, 200)</span>
</pre></div>
</div>
<p>Examine a timeseries of bed elevation by taking slices out of the <code class="docutils literal notranslate"><span class="pre">eta</span></code> variable; we can slice the underlying data directly with an index, the same as a <cite>numpy</cite> array.
Remember that <cite>time</cite> is ordered along the 0th dimension.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># set up indices to slice the cube</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nt</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">golfcube</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">nt</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># linearly interpolate t_idxs</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make the plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nt</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_idxs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># show the slice</span>
<span class="gp">... </span>    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;idx = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="gp">... </span>    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;dim1 </span><span class="se">\n</span><span class="s1"> direction&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;dim2 direction&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guides/userguide-2.png">png</a>, <a class="reference external" href="../guides/userguide-2.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide-2.png" class="plot-directive" src="../_images/userguide-2.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The 0th dimension of the cube must be the <em>time</em> dimension, and the 1st and 2nd dimensions represent the spatial dimensions of the data domain, but can have any arbitrary “name” for the dimensions. For example, from <em>pyDeltaRCM</em> the 1st and 2nd dimensions are named <cite>x</cite> and <cite>y</cite> respectively (<cite>x</cite> is considered a downstream coordinate in that model). In <cite>DeltaMetrics</cite>, we refer to these spatial dimensions as <cite>dim1</cite> and <cite>dim2</cite>, because they may have any name.</p>
</div>
<p>The CubeVariable supports arbitrary math (using <cite>xarray</cite>).
For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># compute the change in bed elevation between the last two intervals above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_time</span> <span class="o">=</span> <span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="n">t_idxs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="n">t_idxs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diff_time</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make the plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">diff_time</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">vmax</span><span class="o">=</span><span class="n">max_delta</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">vmin</span><span class="o">=-</span><span class="n">max_delta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">append_colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>  <span class="c1"># a convenience function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guides/userguide-3.png">png</a>, <a class="reference external" href="../guides/userguide-3.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide-3.png" class="plot-directive" src="../_images/userguide-3.png" />
</figure>
</section>
<section id="manipulating-planform-data">
<h2>Manipulating Planform data<a class="headerlink" href="#manipulating-planform-data" title="Permalink to this heading">¶</a></h2>
<p>In addition to indexing directly, slices along the <cite>Cube</cite> time dimension can be explicitly created as <cite>Planform</cite> objects.
This is helpful for organizing an analysis where you want to repeatedly access data from a particular point in time.</p>
<section id="planform-slices">
<h3>Planform slices<a class="headerlink" href="#planform-slices" title="Permalink to this heading">¶</a></h3>
<p>Create a <cite>Planform</cite> of the last time index from the cube.
The data returned from the planform are an <cite>xarray</cite> <cite>DataArray</cite>, so you can continue to perform arbitrary math on the data.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">final</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">Planform</span><span class="p">(</span><span class="n">golfcube</span><span class="p">,</span> <span class="n">idx</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">final</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(100, 200)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">]</span>
<span class="go">&lt;xarray.DataArray &#39;eta&#39; (x: 100, y: 200)&gt;</span>
<span class="go">array([[ 0.015 ,  0.015 ,  0.015 , ...,  0.015 ,  0.015 ,  0.015 ],</span>
<span class="go">       [ 0.0075,  0.0075,  0.0075, ...,  0.0075,  0.0075,  0.0075],</span>
<span class="go">       [ 0.    ,  0.    ,  0.    , ...,  0.    ,  0.    ,  0.    ],</span>
<span class="go">       ...,</span>
<span class="go">       [-2.    , -2.    , -2.    , ..., -2.    , -2.    , -2.    ],</span>
<span class="go">       [-2.    , -2.    , -2.    , ..., -2.    , -2.    , -2.    ],</span>
<span class="go">       [-2.    , -2.    , -2.    , ..., -2.    , -2.    , -2.    ]],</span>
<span class="go">      dtype=float32)</span>
<span class="go">Coordinates:</span>
<span class="go">    time     float32 5e+07</span>
<span class="go">  * x        (x) float32 0.0 50.0 100.0 150.0 ... 4.85e+03 4.9e+03 4.95e+03</span>
<span class="go">  * y        (y) float32 0.0 50.0 100.0 150.0 ... 9.85e+03 9.9e+03 9.95e+03</span>
<span class="go">Attributes:</span>
<span class="go">    slicetype:           data_planform</span>
<span class="go">    knows_stratigraphy:  False</span>
<span class="go">    knows_spacetime:     True</span>
</pre></div>
</div>
<p>You can visualize the data yourself, or use the built-in <cite>show()</cite> method of a <cite>Planform</cite>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">])</span>   <span class="c1"># display directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">final</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># use the built-in show()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guides/userguide-5.png">png</a>, <a class="reference external" href="../guides/userguide-5.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide-5.png" class="plot-directive" src="../_images/userguide-5.png" />
</figure>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Do <cite>Planform</cite> objects seems too simple? They are! The basic <cite>Planform</cite> allows us to have an API consistent with the more complicated <cite>Section</cite> data (introduced below), and have a flexible standard to extend into “specialty” planforms.</p>
<p>Want to just slice the data directly as <code class="docutils literal notranslate"><span class="pre">golfcube['eta'][-1,</span> <span class="pre">:,</span> <span class="pre">:]</span></code>? Go ahead and do what works for you!</p>
</div>
<p>It is often helpful to associate a <cite>Planform</cite> with a <cite>Cube</cite>, to keep track of planform data from multiple points in time, or from multiple cubes.
Use the <a class="reference internal" href="../_autosummary/deltametrics.cube.DataCube.html#deltametrics.cube.DataCube.register_planform" title="deltametrics.cube.DataCube.register_planform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">register_planform()</span></code></a> method when instantiating the <cite>Planform</cite>, or pass the object as an argument later.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">register_planform</span><span class="p">(</span><span class="s1">&#39;fifty&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">Planform</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
</pre></div>
</div>
<p>Any registered <cite>Planform</cite> can then be accessed via the <a class="reference internal" href="../_autosummary/deltametrics.cube.DataCube.html#deltametrics.cube.DataCube.planforms" title="deltametrics.cube.DataCube.planforms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">planforms</span></code></a> attribute of the Cube (returns a <cite>dict</cite>).</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">planforms</span><span class="p">[</span><span class="s1">&#39;fifty&#39;</span><span class="p">]</span>
<span class="go">&lt;deltametrics.plan.Planform object at 0x...&gt;</span>
</pre></div>
</div>
</section>
<section id="specialty-planform-objects">
<h3>Specialty Planform objects<a class="headerlink" href="#specialty-planform-objects" title="Permalink to this heading">¶</a></h3>
<p>A slice of the <cite>Cube</cite> is a basic <cite>Planform</cite>, but often there are some analyses we wish to compute on a <cite>Planform</cite>, that may have multiple steps and sets of derived values we want to keep track of.
DeltaMetrics has several specialty planform objects that make this easier.
These specialty calculations are beyond the scope of this basic user guide, find more information on the <a class="reference internal" href="../reference/plan/index.html"><span class="doc">Planform API reference page</span></a>.</p>
</section>
</section>
<section id="manipulating-section-data">
<h2>Manipulating Section data<a class="headerlink" href="#manipulating-section-data" title="Permalink to this heading">¶</a></h2>
<p>Similar to <cite>Planform</cite> slices, we can make cuts <em>across</em> the <cite>Cube</cite> time dimension with <cite>Section</cite> objects.
Most often, it’s best to use the API to register a section of a specified type to an underlying data cube and
assigning it a name (“demo” below).
Registered sections are accessed via the <code class="docutils literal notranslate"><span class="pre">sections</span></code> attribute of the cube:</p>
<p>For a data cube, sections are most easily instantiated by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">register_section</span></code> method:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">register_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">StrikeSection</span><span class="p">(</span><span class="n">distance_idx</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>which creates a section across a constant y-value <code class="docutils literal notranslate"><span class="pre">==10</span></code>.
The path of any <cite>Section</cite> in the <code class="docutils literal notranslate"><span class="pre">x-y</span></code> plane can always be accessed via the <code class="docutils literal notranslate"><span class="pre">.trace</span></code> attribute.
We can plot the trace on top the the final bed elevation to see where the section will be located.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">quick_show</span><span class="p">(</span><span class="s1">&#39;eta&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">golfcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">trace</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="n">golfcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">trace</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
<p>(<a class="reference external" href="../pyplots/guides/userguide_strikesection_location.png">png</a>, <a class="reference external" href="../pyplots/guides/userguide_strikesection_location.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide_strikesection_location.png" class="plot-directive" src="../_images/userguide_strikesection_location.png" />
</figure>
<p>Any registered section can then be accessed via the <code class="xref py py-obj docutils literal notranslate"><span class="pre">sections</span></code> attribute of the Cube (returns a <cite>dict</cite>).</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">]</span>
<span class="go">&lt;deltametrics.section.StrikeSection object at 0x...&gt;</span>
</pre></div>
</div>
<p>Available section types are <code class="docutils literal notranslate"><span class="pre">PathSection</span></code>, <code class="docutils literal notranslate"><span class="pre">StrikeSection</span></code>,
<code class="docutils literal notranslate"><span class="pre">DipSection</span></code>, and <code class="docutils literal notranslate"><span class="pre">RadialSection</span></code>.
Notably, <cite>Sections</cite> do not refer to any variable in particular, so <cite>Sections</cite>
are sliced themselves, similarly to the cube.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">register_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">StrikeSection</span><span class="p">(</span><span class="n">distance_idx</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">][</span><span class="s1">&#39;velocity&#39;</span><span class="p">]</span>
<span class="go">&lt;xarray.DataArray &#39;velocity&#39; (time: 101, s: 200)&gt;</span>
<span class="go">array([[0.2   , 0.2   , 0.2   , ..., 0.2   , 0.2   , 0.2   ],</span>
<span class="go">       [0.    , 0.    , 0.    , ..., 0.    , 0.    , 0.    ],</span>
<span class="go">       [0.    , 0.0025, 0.    , ..., 0.    , 0.    , 0.    ],</span>
<span class="go">       ...,</span>
<span class="go">       [0.    , 0.    , 0.    , ..., 0.0025, 0.    , 0.    ],</span>
<span class="go">       [0.    , 0.    , 0.    , ..., 0.    , 0.    , 0.    ],</span>
<span class="go">       [0.    , 0.    , 0.    , ..., 0.0025, 0.    , 0.    ]],</span>
<span class="go">      dtype=float32)</span>
<span class="go">Coordinates:</span>
<span class="go">  * s        (s) float64 0.0 50.0 100.0 150.0 ... 9.85e+03 9.9e+03 9.95e+03</span>
<span class="go">  * time     (time) float32 0.0 5e+05 1e+06 1.5e+06 ... 4.9e+07 4.95e+07 5e+07</span>
<span class="go">Attributes:</span>
<span class="go">    slicetype:           data_section</span>
<span class="go">    knows_stratigraphy:  False</span>
<span class="go">    knows_spacetime:     True</span>
</pre></div>
</div>
<p>We can visualize sections:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">show_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="s1">&#39;eta&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">show_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">show_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="s1">&#39;sandfrac&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
<p>(<a class="reference external" href="../pyplots/guides/userguide_three_spacetime_sections.png">png</a>, <a class="reference external" href="../pyplots/guides/userguide_three_spacetime_sections.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide_three_spacetime_sections.png" class="plot-directive" src="../_images/userguide_three_spacetime_sections.png" />
</figure>
<p>You can also create a standalone section, which is not registered to the cube, but still supports slicing from the underlying dataset.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sass</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">StrikeSection</span><span class="p">(</span><span class="n">golfcube</span><span class="p">,</span> <span class="n">distance_idx</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">sass</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">golfcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">][</span><span class="s1">&#39;velocity&#39;</span><span class="p">])</span> 
<span class="go">True</span>
</pre></div>
</div>
<section id="quick-stratigraphy">
<span id="userguide-quick-stratigraphy"></span><h3>“Quick” stratigraphy<a class="headerlink" href="#quick-stratigraphy" title="Permalink to this heading">¶</a></h3>
<p>We are often interested in not only the spatiotemporal changes in the planform of the delta, but we want to know what is preserved in the subsurface.
In DeltaMetrics, we refer to this preserved history as the “stratigraphy”, and we provide a number of convenient routines for computing stratigraphy and analyzing deposits.</p>
<p>Importantly, stratigraphy (or i.e., which voxels are preserved) is not computed by default when a Cube instance is created.
We must directly tell the Cube instance to compute stratigraphy by specifying which variable contains the bed elevation history, because this history dictates preservation.
We have implemented support for rapid stratigraphy computation for visualization, and preserved-time statistics.
These quick stratigraphy computations create a mesh of preserved elevations and fill this matrix with values sliced out of the underlying data.</p>
<p>Compute “quick stratigraphy” as:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">stratigraphy_from</span><span class="p">(</span><span class="s1">&#39;eta&#39;</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, the <code class="docutils literal notranslate"><span class="pre">DataCube</span></code> has knowledge of stratigraphy, which we can further use to visualize preservation within the spacetime, or visualize as an actual stratigraphic slice.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">][</span><span class="s1">&#39;velocity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strat</span><span class="o">.</span><span class="n">as_preserved</span><span class="p">()</span>
<span class="go">&lt;xarray.DataArray &#39;velocity&#39; (time: 101, s: 200)&gt;</span>
<span class="go">array([[0.2, 0.2, 0.2, ..., 0.2, 0.2, 0.2],</span>
<span class="go">       [nan, nan, nan, ..., nan, nan, nan],</span>
<span class="go">       [nan, nan, nan, ..., nan, nan, nan],</span>
<span class="go">       ...,</span>
<span class="go">       [nan, nan, nan, ..., nan, nan, nan],</span>
<span class="go">       [nan, nan, nan, ..., nan, nan, nan],</span>
<span class="go">       [nan, nan, nan, ..., nan, nan, nan]], dtype=float32)</span>
<span class="go">Coordinates:</span>
<span class="go">  * s        (s) float64 0.0 50.0 100.0 150.0 ... 9.85e+03 9.9e+03 9.95e+03</span>
<span class="go">  * time     (time) float32 0.0 5e+05 1e+06 1.5e+06 ... 4.9e+07 4.95e+07 5e+07</span>
<span class="go">Attributes:</span>
<span class="go">    slicetype:           data_section</span>
<span class="go">    knows_stratigraphy:  True</span>
<span class="go">    knows_spacetime:     True</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">show_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">show_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;preserved&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">show_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;stratigraphy&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
<p>(<a class="reference external" href="../pyplots/guides/userguide_quick_stratigraphy_sections.png">png</a>, <a class="reference external" href="../pyplots/guides/userguide_quick_stratigraphy_sections.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide_quick_stratigraphy_sections.png" class="plot-directive" src="../_images/userguide_quick_stratigraphy_sections.png" />
</figure>
<p>Quick stratigraphy makes it easy to visualize the behavior of the model across each of the variables:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;eta&#39;</span><span class="p">,</span> <span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge&#39;</span><span class="p">,</span> <span class="s1">&#39;sandfrac&#39;</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="n">golfcube</span><span class="o">.</span><span class="n">show_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">style</span><span class="o">=</span><span class="s1">&#39;shaded&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;stratigraphy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
<p>(<a class="reference external" href="../pyplots/guides/userguide_quick_stratigraphy_all_variables.png">png</a>, <a class="reference external" href="../pyplots/guides/userguide_quick_stratigraphy_all_variables.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide_quick_stratigraphy_all_variables.png" class="plot-directive" src="../_images/userguide_quick_stratigraphy_all_variables.png" />
</figure>
</section>
<section id="all-section-types">
<h3>All Section types<a class="headerlink" href="#all-section-types" title="Permalink to this heading">¶</a></h3>
<p>There are multiple section types available.
The <cite>Section</cite> classes all inherit from the same <code class="docutils literal notranslate"><span class="pre">BaseSection</span></code> class, which means they mostly have the same options available to them, and have a common API.
Each <cite>Section</cite> requires unique instantiation arguments, though, which must be properly specified.
The below figure shows each section type available and the <cite>velocity</cite> spacetime data extracted along that section.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_strike</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">StrikeSection</span><span class="p">(</span><span class="n">golfcube</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_path</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">PathSection</span><span class="p">(</span><span class="n">golfcube</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1400</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">],</span> <span class="p">[</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_circ</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">CircularSection</span><span class="p">(</span><span class="n">golfcube</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_rad</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">RadialSection</span><span class="p">(</span><span class="n">golfcube</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../pyplots/guides/userguide_section_type_demos.png">png</a>, <a class="reference external" href="../pyplots/guides/userguide_section_type_demos.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide_section_type_demos.png" class="plot-directive" src="../_images/userguide_section_type_demos.png" />
</figure>
</section>
</section>
<section id="default-colors-in-deltametrics">
<h2>Default Colors in DeltaMetrics<a class="headerlink" href="#default-colors-in-deltametrics" title="Permalink to this heading">¶</a></h2>
<p>You may have noticed the beautiful colors above, and be wondering: “how are the colors set?”
We use a custom object (<a class="reference internal" href="../_autosummary/deltametrics.plot.VariableSet.html#deltametrics.plot.VariableSet" title="deltametrics.plot.VariableSet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VariableSet</span></code></a>) to define common plotting properties for all plots.
The <cite>VariableSet</cite> supports all kinds of other controls, such as custom colormaps for any variable, addition of new defined variables, fixed color limits, color normalizations, and more.
You can also use these attributes of the <cite>VariableSet</cite> in your own plotting routines.</p>
<p>See the <a class="reference internal" href="../reference/plot/index.html#default-styling"><span class="std std-ref">default colors in DeltaMetrics here</span></a> for more information.</p>
<p>Additionally, there are a <a class="reference internal" href="../reference/plot/index.html"><span class="doc">number of plotting routines</span></a> that are helpful in visualizations.</p>
</section>
<section id="computing-and-manipulating-stratigraphy">
<h2>Computing and Manipulating Stratigraphy<a class="headerlink" href="#computing-and-manipulating-stratigraphy" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="#userguide-quick-stratigraphy"><span class="std std-ref">Quick stratigraphy</span></a> works great for statistics of what-is-preserved and for quick visualizations, but it has several limitations.
1) Does not consider volume of sediment filled by preserved-time indicies, 2) cannot be sliced by planform, 3) irregularity does not lend well to computation and other uses (hydrological studies).</p>
<p>So, we want to be able to create what I refer to as “boxy” stratigraphy.
This has been done in the past by “placing” values from, e.g., <code class="docutils literal notranslate"><span class="pre">sandfrac</span></code> into stratigraphy.
This requires full computation for any variable you want to examine though.
Here, we use a method that computes boxy stratigraphy only once, then synthesizes the volume from
the precomputed sparse indicies.</p>
<p>Here’s a simple example to demonstrate how we place data into the stratigraphy.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ets</span> <span class="o">=</span> <span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][:,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">85</span><span class="p">]</span>  <span class="c1"># a &quot;real&quot; slice of the model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">show_one_dimensional_trajectory_to_strata</span><span class="p">(</span><span class="n">ets</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
<p>(<a class="reference external" href="../pyplots/guides/userguide_1d_example.png">png</a>, <a class="reference external" href="../pyplots/guides/userguide_1d_example.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide_1d_example.png" class="plot-directive" src="../_images/userguide_1d_example.png" />
</figure>
<p>Begin by creating a <code class="docutils literal notranslate"><span class="pre">StratigraphyCube</span></code>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stratcube</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">StratigraphyCube</span><span class="o">.</span><span class="n">from_DataCube</span><span class="p">(</span><span class="n">golfcube</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stratcube</span><span class="o">.</span><span class="n">variables</span>
<span class="go">[&#39;eta&#39;, &#39;stage&#39;, &#39;depth&#39;, &#39;discharge&#39;, &#39;velocity&#39;, &#39;sedflux&#39;, &#39;sandfrac&#39;]</span>
</pre></div>
</div>
<p>We can then slice this cube in the same way as the <code class="docutils literal notranslate"><span class="pre">DataCube</span></code>, but what we get back is <em>stratigraphy</em> rather than <em>spacetime</em>.
Compare the slice from the <cite>golfcube</cite> (left) to the <cite>stratcube</cite> (right):</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">stratcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
<p>(<a class="reference external" href="../pyplots/guides/userguide_compare_slices.png">png</a>, <a class="reference external" href="../pyplots/guides/userguide_compare_slices.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide_compare_slices.png" class="plot-directive" src="../_images/userguide_compare_slices.png" />
</figure>
<p>Validation of the stratigraphy is easily seen by looking at the <code class="docutils literal notranslate"><span class="pre">time</span></code> attribute.
Note that sections are <em>not</em> inherited from the <code class="docutils literal notranslate"><span class="pre">DataCube</span></code> by default (we’re working on this and related features).</p>
<p>Let’s add a section at the same location as <code class="docutils literal notranslate"><span class="pre">golfcube.sections['demo']</span></code>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stratcube</span><span class="o">.</span><span class="n">register_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">StrikeSection</span><span class="p">(</span><span class="n">distance_idx</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stratcube</span><span class="o">.</span><span class="n">sections</span>
<span class="go">{&#39;demo&#39;: &lt;deltametrics.section.StrikeSection object at 0x...&gt;}</span>
</pre></div>
</div>
<p>Let’s examine the stratigraphy in three different visual styles.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;stratigraphy&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stratcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">golfcube</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;demo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;stratigraphy&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
<p>(<a class="reference external" href="../pyplots/guides/userguide_three_stratigraphy.png">png</a>, <a class="reference external" href="../pyplots/guides/userguide_three_stratigraphy.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide_three_stratigraphy.png" class="plot-directive" src="../_images/userguide_three_stratigraphy.png" />
</figure>
<p>Similar to the demonstration above, each variable (property) of the underlying cube can be displayed. These displays utilize the same <em>precomputed</em> locations in the stratigraphy and simply filled the synthesized matrix with the different variable values.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;eta&#39;</span><span class="p">,</span> <span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge&#39;</span><span class="p">,</span> <span class="s1">&#39;sandfrac&#39;</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="n">stratcube</span><span class="o">.</span><span class="n">show_section</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">style</span><span class="o">=</span><span class="s1">&#39;shaded&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;stratigraphy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
<p>(<a class="reference external" href="../pyplots/guides/userguide_all_vars_stratigraphy.png">png</a>, <a class="reference external" href="../pyplots/guides/userguide_all_vars_stratigraphy.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide_all_vars_stratigraphy.png" class="plot-directive" src="../_images/userguide_all_vars_stratigraphy.png" />
</figure>
<p id="userguide-stratigraphy-planforms">The stratigraphy cube allows us to slice <cite>Planform</cite> stratigraphy too.
Specify <cite>z</cite> as the elevation of the planform slice:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">minus2_slice</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">plan</span><span class="o">.</span><span class="n">Planform</span><span class="p">(</span><span class="n">stratcube</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minus2_slice</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guides/userguide-7.png">png</a>, <a class="reference external" href="../guides/userguide-7.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide-7.png" class="plot-directive" src="../_images/userguide-7.png" />
</figure>
<section id="frozen-stratigraphy-volumes">
<h3>Frozen stratigraphy volumes<a class="headerlink" href="#frozen-stratigraphy-volumes" title="Permalink to this heading">¶</a></h3>
<p>We still support creating “frozen” cubes, which might be useful for to
speed up computations if an array is being accessed over and over.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">stratcube</span><span class="o">.</span><span class="n">export_frozen_variable</span><span class="p">(</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">)</span>
<span class="n">fe</span> <span class="o">=</span> <span class="n">stratcube</span><span class="o">.</span><span class="n">Z</span>  <span class="c1"># exported volume does not have coordinate information!</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">pcm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span>
   <span class="n">fe</span><span class="p">[:,</span><span class="mi">10</span><span class="p">,:],</span> <span class="n">fs</span><span class="p">[:,</span><span class="mi">10</span><span class="p">,:],</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
   <span class="n">cmap</span><span class="o">=</span><span class="n">golfcube</span><span class="o">.</span><span class="n">varset</span><span class="p">[</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
   <span class="n">vmin</span><span class="o">=</span><span class="n">golfcube</span><span class="o">.</span><span class="n">varset</span><span class="p">[</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span>
   <span class="n">vmax</span><span class="o">=</span><span class="n">golfcube</span><span class="o">.</span><span class="n">varset</span><span class="p">[</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">vmax</span><span class="p">)</span>
<span class="n">dm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">append_colorbar</span><span class="p">(</span><span class="n">pcm</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1">#doctest: +SKIP</span>
</pre></div>
</div>
<p>Note than you can also bypass the creation of a <code class="docutils literal notranslate"><span class="pre">StratigraphyCube</span></code>,
and just directly obtain a frozen volume with:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span><span class="p">,</span> <span class="n">fe</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">strat</span><span class="o">.</span><span class="n">compute_boxy_stratigraphy_volume</span><span class="p">(</span><span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">],</span> <span class="n">golfcube</span><span class="p">[</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">],</span> <span class="n">dz</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<p>However, this will require recomputing the stratigraphy preservation to create another cube in the future, and because the <code class="docutils literal notranslate"><span class="pre">StratigraphyCube</span></code> stores data on disk, the memory footprint is relatively small, and so we recommend just computing the <code class="docutils literal notranslate"><span class="pre">StratigraphyCube</span></code> and using the <code class="docutils literal notranslate"><span class="pre">export_frozen_variable)</span></code> method.
Finally, <code class="docutils literal notranslate"><span class="pre">DataCubeVariable</span></code> and <code class="docutils literal notranslate"><span class="pre">StratigraphyCubeVariable</span></code> support a <code class="docutils literal notranslate"><span class="pre">.as_frozen()</span></code> method themselves.</p>
<p>We should verify that the frozen cubes actually match the underlying data!</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span> <span class="n">fs</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">fs</span><span class="p">)]</span> <span class="o">==</span> <span class="n">stratcube</span><span class="p">[</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">][</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">stratcube</span><span class="p">[</span><span class="s1">&#39;sandfrac&#39;</span><span class="p">])]</span> <span class="p">)</span> 
<span class="go">True</span>
</pre></div>
</div>
<p>The access speed of a frozen volume is <strong>much</strong> faster than a live cube.
This is because the live cube does not store any data in memory.
Keeping data on disk is advantageous for large datasets, but slows down access considerably for computation.
<strong>The speed of access in a frozen cube may be several thousand times faster, so it can be advantageous to export frozen cubes before computation.</strong>
See a <a class="reference internal" href="examples/computations/comparing_speeds_of_stratigraphy_access.html"><span class="doc">demonstration of the speed comparison in the Examples library</span></a>.</p>
</section>
</section>
<section id="masks">
<h2>Masks<a class="headerlink" href="#masks" title="Permalink to this heading">¶</a></h2>
<p>We have implemented operations to compute masks of several types.</p>
<p>By design, masks can be instantiated directly from the most basic “raw data” components (e.g., a channel <code class="xref py py-obj docutils literal notranslate"><span class="pre">CenterlineMask</span></code> from <cite>eta</cite> and  <cite>velocity</cite>).
This is convenient, and can be a great way to quickly explore data and prototype algorithms; however, it is often more computationally efficient to reuse a precomputed mask (and <cite>Planform</cite> objects) to compute a new mask.
We describe the relationships between various <cite>Mask</cite> types, and best practices for creating each on the <a class="reference internal" href="../reference/mask/index.html"><span class="doc">reference page for masks</span></a>.</p>
<dl class="simple">
<dt>Currently implemented <cite>Masks</cite>:</dt><dd><ul class="simple">
<li><p>ElevationMask</p></li>
<li><p>FlowMask</p></li>
<li><p>LandMask</p></li>
<li><p>ShorelineMask</p></li>
<li><p>WetMask</p></li>
<li><p>EdgeMask</p></li>
<li><p>ChannelMask</p></li>
<li><p>CenterlineMask</p></li>
</ul>
</dd>
</dl>
<p>Below, we demonstrate how some of the masks can be instantiated from the most basic data components.
Instantiating <em>most</em> masks requires a keyword parameter <cite>elevation_threshold</cite>; the exact context of this parameter may depend on the mask type, but it is often the sea-level elevation.
See the <a class="reference internal" href="../reference/mask/index.html"><span class="doc">reference page for each mask type</span></a> if you are unsure.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># use a new cube</span>
<span class="n">maskcube</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">sample_data</span><span class="o">.</span><span class="n">golf</span><span class="p">()</span>

<span class="c1"># create the masks from variables in the cube</span>
<span class="n">land_mask</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">LandMask</span><span class="p">(</span>
    <span class="n">maskcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
    <span class="n">elevation_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">wet_mask</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">WetMask</span><span class="p">(</span>
    <span class="n">maskcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
    <span class="n">elevation_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">channel_mask</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">ChannelMask</span><span class="p">(</span>
    <span class="n">maskcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
    <span class="n">maskcube</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
    <span class="n">elevation_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">flow_threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">centerline_mask</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">CenterlineMask</span><span class="p">(</span>
    <span class="n">maskcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
    <span class="n">maskcube</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
    <span class="n">elevation_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">flow_threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">edge_mask</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">EdgeMask</span><span class="p">(</span>
    <span class="n">maskcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
    <span class="n">elevation_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">shore_mask</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">ShorelineMask</span><span class="p">(</span>
    <span class="n">maskcube</span><span class="p">[</span><span class="s1">&#39;eta&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
    <span class="n">elevation_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../guides/userguide-10.png">png</a>, <a class="reference external" href="../guides/userguide-10.hires.png">hires.png</a>)</p>
<figure class="align-default">
<img alt="../_images/userguide-10.png" class="plot-directive" src="../_images/userguide-10.png" />
</figure>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">User Guide</a><ul>
<li><a class="reference internal" href="#setting-up-your-coding-environment">Setting up your coding environment</a></li>
<li><a class="reference internal" href="#create-and-manipulate-a-datacube">Create and manipulate a “DataCube”</a></li>
<li><a class="reference internal" href="#manipulating-planform-data">Manipulating Planform data</a><ul>
<li><a class="reference internal" href="#planform-slices">Planform slices</a></li>
<li><a class="reference internal" href="#specialty-planform-objects">Specialty Planform objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manipulating-section-data">Manipulating Section data</a><ul>
<li><a class="reference internal" href="#quick-stratigraphy">“Quick” stratigraphy</a></li>
<li><a class="reference internal" href="#all-section-types">All Section types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#default-colors-in-deltametrics">Default Colors in DeltaMetrics</a></li>
<li><a class="reference internal" href="#computing-and-manipulating-stratigraphy">Computing and Manipulating Stratigraphy</a><ul>
<li><a class="reference internal" href="#frozen-stratigraphy-volumes">Frozen stratigraphy volumes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#masks">Masks</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="10min.html"
                          title="previous chapter">Getting started with a 10-minute tutorial</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="examples/index.html"
                          title="next chapter">Examples</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/guides/userguide.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="examples/index.html" title="Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="10min.html" title="Getting started with a 10-minute tutorial"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DeltaMetrics 0.3.3 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">User Guide</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, The DeltaRCM Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.2.3.
    </div>
  </body>
</html>